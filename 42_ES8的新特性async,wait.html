<!--
 * @Author: lu
 * @Date: 2020-09-27 16:37:05
 * @LastEditTime: 2020-10-12 15:36:03
 * @FilePath: \GSG-ES6-ES11\42_ES8的新特性.html
 * @Description: 
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>42_ES8的新特性</title>
</head>

<body>
    <!-- 
    1. async 和 await 两种语法结合可以让异步代码像同步代码一样
    2. async 函数，async的返回值为 promise 对象，promise对象的结果由 async 函数执行结果决定
    3. await 表达式，必须写在 async 函数中，右侧的表达式一般为promise对象，返回的是promise的值，
       如果失败了，需要通过try...catch捕获处理
 -->
    <script>
        async function fn() {
            // 返回的结果不是一个 Promise 类型的对象，返回的结果就是成功 Promise 对象
            // return '字符串'
            // 抛出错误，返回的结果是一个失败的 Promise
            // throw new Error('出错了');
            // 返回的结果是一个 Promise 对象
            return new Promise((resolve, reject) => {
                resolve('成功数据')
            })
        }

        const result = fn();
        console.log(result);
        result.then(value => {
            console.log(value);
        });

        const p = new Promise((resolve, reject) => {
            // resolve('成功了！')
            reject('失败了')
        });

        async function main() {
            try {
                const result = await p;
            } catch (e) {
                console.log(e);
            }
        }
        main()
    </script>
</body>

</html>